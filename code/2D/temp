

a = rand([3 8]);
b = rand([3 3]);
c = rand([3 8]);
d = rand([8 1]);
max(b*(a+c)*d)
% - b*a*d - b*c*d

syms xa ya;
n = 1/4*[(1-xa)*(1-ya) (1+xa)*(1-ya) (1+xa)*(1+ya) (1-xa)*(1+ya)];
B = sym('b', [3 8]);
for i=1:4
  B(1:3,i*2-1:i*2) = [diff(n(i), xa) 0; 0 diff(n(i), ya); diff(n(i), ya) diff(n(i),xa)];
end
subs(subs(B, xa, 0), ya, 0) + ...
subs(subs(B, xa, 1), ya, 0) + ...
subs(subs(B, xa, 0), ya, 1) + ...
subs(subs(B, xa, 1), ya, 1)